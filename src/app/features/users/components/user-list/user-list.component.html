<div class="user-list">
  <p-card>
    <ng-template pTemplate="header">
      <div class="card-header">
        <div>
          <h2>{{ pageTitle() }}</h2>
          <p class="subtitle">{{ pageSubtitle() }}</p>
        </div>
      </div>
    </ng-template>

    <app-error-message [onDismiss]="clearError" />
    <app-loading-spinner />

    @if (canViewUsers()) {
      @if (!loadingService.loading()) {
        <p-table
          [value]="users()"
          dataKey="userId"
          [rowTrackBy]="trackByUserId"
          [paginator]="true"
          [rows]="10"
          [showCurrentPageReport]="true"
          [lazy]="true"
          (onLazyLoad)="onLazyLoad($event)"
          [totalRecords]="totalRecords()"
          currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
          [rowsPerPageOptions]="[10, 25, 50]">
          <ng-template pTemplate="header">
            <tr>
              <th>Name</th>
              <th>Email</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-user>
            <tr>
              <td>{{ displayName(user) }}</td>
              <td>{{ user.email }}</td>
            </tr>
          </ng-template>
        </p-table>
      }
      @if (!loadingService.loading() && users().length === 0) {
        <div class="empty-state">
          <i class="pi pi-users" style="font-size: 3rem; color: #999;"></i>
          <p>No users found.</p>
        </div>
      }
    }
  </p-card>
</div>
